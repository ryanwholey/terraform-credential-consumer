name: Terraform Cloud Workspace
on:
  pull_request:
    paths:
      - .github/workflows/test-merge-json-array.yml
  push:
    branches:
      - main
    paths:
      - .github/workflows/test-merge-json-array.yml
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - id: simulate-fetch
        run: echo '::set-output name=fetched::["foo", "bar"]'
      - id: simulate-input
        run: |-
          str=["baz","woz"]
          echo "::add-mask::$str"
          echo "::set-output name=input::$str"
      - uses: actions/github-script@v5
        id: result
        with:
          script: |-
            if (${{ steps.simulate-input.outputs.input }}[0] === '*') {
              console.log('masked in template')
            }
            // const fetched = JSON.parse('${{ steps.simulate-fetch.outputs.fetched }}' || '[]')
            // const inputs = JSON.parse('${{ steps.simulate-input.outputs.input }}' || '[]')

            // return [...fetched, ...inputs]
            return []
      - run: echo ${{ steps.result.outputs.result }}
